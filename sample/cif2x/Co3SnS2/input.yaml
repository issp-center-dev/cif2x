structure:
  use_ibrav: false
  tolerance: 0.05

optional:
  pseudo_dir: &pseudo_dir ../pseudo
  pp_file: ../pseudo/pp_psl_pbe_rrkjus.csv

tasks:
  - mode: scf
    output_file: scf.in
    content:
      namelist:
        control:
          prefix: pwscf
          pseudo_dir: *pseudo_dir
          outdir: ./work
          tstress: true
          tprnfor: true
        system:
          ibrav:
          nat:
          ntyp:
          ecutwfc:
          ecutrho:
          occupations: smearing
          smearing: m-p
          degauss: 0.01
          nspin: 2
        electrons:
          mixing_beta: 0.1
          conv_thr: 1.e-8
      CELL_PARAMETERS:
      ATOMIC_SPECIES:
      ATOMIC_POSITIONS:
        option: crystal
      K_POINTS:
        option: automatic

  - mode: nscf
    output_file: nscf.in
    content:
      namelist:
        control:
          prefix: pwscf
          pseudo_dir: *pseudo_dir
          outdir: ./work
          tstress: true
          tprnfor: true
          verbosity: high
        system:
          ibrav:
          nat:
          ntyp:
          ecutwfc: 36.0   #fixed
          ecutrho: 180.0  #fixed
          occupations: smearing
          smearing: m-p
          degauss: 0.01
          nbnd:
          noncolin: true
          #lforcet: true
        electrons:
          mising_beta: 0.1
          conv_thr: 1.e-8
      CELL_PARAMETERS:
      ATOMIC_SPECIES:
      ATOMIC_POSITIONS:
        option: crystal
      K_POINTS:
        option: crystal

  - mode: pw2wan
    output_file: pw2wan.in
    content:
      namelist:
        inputpp:
          prefix: pwscf
          outdir: ./work
          seedname: pwscf
          irr_bz: true

  - mode: bands
    output_file: band.in
    template: band.in_tmpl
    #content:
