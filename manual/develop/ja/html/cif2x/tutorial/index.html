<!DOCTYPE html>

<html lang="ja" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3. チュートリアル &#8212; cif2x Users Guide 1.1.0 ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=94bc0932" />
    <script src="../../_static/documentation_options.js?v=6599c6cf"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=91613774"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="4. コマンドリファレンス" href="../command/index.html" />
    <link rel="prev" title="2. インストールと基本的な使い方" href="../basic-usage.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="sec-cif2x-tutorial">
<span id="id1"></span><h1><span class="section-number">3. </span>チュートリアル<a class="headerlink" href="#sec-cif2x-tutorial" title="Link to this heading">¶</a></h1>
<p>第一原理計算入力ファイル生成ツール cif2x を使うには、入力パラメータファイルと結晶構造データおよび擬ポテンシャルファイルを用意した後、プログラム cif2x を実行します。現在は Quantum ESPRESSO, VASP, OpenMX, AkaiKKR の入力ファイル生成に対応しています。以下では、 <code class="docutils literal notranslate"><span class="pre">docs/tutorial/cif2x</span></code> ディレクトリにある Quantum ESPRESSO 向けサンプルを例にチュートリアルを実施します。</p>
<section id="id2">
<h2><span class="section-number">3.1. </span>入力パラメータファイルを作成する<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p>入力パラメータファイルには、第一原理計算プログラムに与える入力ファイルの内容を記述します。</p>
<p>以下に入力パラメータファイルのサンプルを記載します。このファイルは YAML形式のテキストファイルで、結晶構造データに対するオプションの指定や、出力する第一原理計算入力ファイルの内容を記述します。仕様の詳細については <a class="reference internal" href="../filespec/index.html#sec-cif2x-fileformat"><span class="std std-ref">ファイルフォーマット</span></a> の章を参照してください。</p>
<p>YAMLフォーマットでは、 <code class="docutils literal notranslate"><span class="pre">keyword:</span> <span class="pre">value</span></code> の辞書形式でパラメータを記述します。 <code class="docutils literal notranslate"><span class="pre">value</span></code> には数値や文字列などのスカラー値や、複数の値を <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span></code> または箇条書きの形式で列挙するリスト型、または辞書型を入れ子にすることができます。</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">structure</span><span class="p">:</span>
<span class="w">  </span><span class="nt">use_ibrav</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">tolerance</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.05</span>

<span class="nt">optional</span><span class="p">:</span>
<span class="w">  </span><span class="nt">pseudo_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./pseudo</span>
<span class="w">  </span><span class="nt">pp_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./pseudo/pp_psl_pbe_rrkjus.csv</span>

<span class="nt">tasks</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scf</span>
<span class="w">    </span><span class="nt">output_file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scf.in</span>
<span class="w">    </span><span class="nt">output_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scf</span>
<span class="w">    </span><span class="nt">template</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scf.in_tmpl</span>
<span class="w">    </span><span class="nt">content</span><span class="p">:</span>
<span class="w">      </span><span class="nt">namelist</span><span class="p">:</span>
<span class="w">        </span><span class="nt">control</span><span class="p">:</span>
<span class="w">          </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pwscf</span>
<span class="w">          </span><span class="nt">pseudo_dir</span><span class="p">:</span>
<span class="w">          </span><span class="nt">outdir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./work</span>
<span class="w">        </span><span class="nt">system</span><span class="p">:</span>
<span class="w">          </span><span class="nt">ecutwfc</span><span class="p">:</span>
<span class="w">          </span><span class="nt">ecutrho</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CELL_PARAMETERS</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ATOMIC_SPECIES</span><span class="p">:</span>
<span class="w">      </span><span class="nt">ATOMIC_POSITIONS</span><span class="p">:</span>
<span class="w">        </span><span class="nt">option</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crystal</span>
<span class="w">      </span><span class="nt">K_POINTS</span><span class="p">:</span>
<span class="w">        </span><span class="nt">option</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">automatic</span>
<span class="w">        </span><span class="nt">grid</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="nv">8</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>入力パラメータファイルは <code class="docutils literal notranslate"><span class="pre">structure</span></code>, <code class="docutils literal notranslate"><span class="pre">optional</span></code>, <code class="docutils literal notranslate"><span class="pre">tasks</span></code> のブロックから構成されます。
<code class="docutils literal notranslate"><span class="pre">structure</span></code> は結晶構造データに関するオプションを指定します。
<code class="docutils literal notranslate"><span class="pre">optional</span></code> は擬ポテンシャルに関する global な設定などを行います。</p>
<p><code class="docutils literal notranslate"><span class="pre">tasks</span></code> は出力する第一原理計算入力ファイルの内容を指定します。一連の計算に対応して複数のファイルを生成できるよう、tasks は配列の値を取ります。
各出力について、計算内容は <code class="docutils literal notranslate"><span class="pre">mode</span></code> パラメータで指定します。SCF計算の <code class="docutils literal notranslate"><span class="pre">scf</span></code> や NSCF計算の <code class="docutils literal notranslate"><span class="pre">nscf</span></code> に対応するほか、一般的な出力を行う任意の出力モードを指定できます。
ファイルは <code class="docutils literal notranslate"><span class="pre">output_dir</span></code> および <code class="docutils literal notranslate"><span class="pre">output_file</span></code> で指定するファイルに書き出されます。</p>
<p>出力内容は <code class="docutils literal notranslate"><span class="pre">content</span></code> に記載します。
Quantum ESPRESSO の入力ファイルは、 <code class="docutils literal notranslate"><span class="pre">&amp;keyword</span></code> で始まる Fortran90 の namelist 形式と、 <code class="docutils literal notranslate"><span class="pre">K_POINTS</span></code> などのキーワードで始まり空行で分割される cards と呼ばれるブロックからなります。 <code class="docutils literal notranslate"><span class="pre">content</span></code> には namelist と cards を入れ子の辞書形式で指定します。
いくつかの例外を除いて、指定された内容が基本的にはそのまま入力ファイルに書き出されます。値が空欄のキーワードは、結晶構造データなどから求めた値が代入されます。</p>
<p>また、template として入力ファイルの雛形を指定することもできます。 <code class="docutils literal notranslate"><span class="pre">template</span></code> に指定したファイルの内容と <code class="docutils literal notranslate"><span class="pre">content</span></code> のデータを合わせたものを入力データとして扱います。同じキーワードのデータが存在する場合は <code class="docutils literal notranslate"><span class="pre">content</span></code> の指定が優先されます。従って、既存の入力ファイルを元に必要な箇所を入力パラメータファイルで上書きする使い方が可能です。上記の例では次のファイル(<code class="docutils literal notranslate"><span class="pre">scf.in_tmpl</span></code>)を template として取り込み、カットオフと CELL_PARAMETER, ATOMIC_SPECIES, ATOMIC_POSITIONS, K_POINT の箇所を結晶構造等から決めます。 <code class="docutils literal notranslate"><span class="pre">ecutwfc</span></code> と <code class="docutils literal notranslate"><span class="pre">ecutrho</span></code> が空欄で上書きされていることに留意してください。</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="p">&amp;</span><span class="n">control</span>
<span class="w">    </span><span class="n">calculation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;scf&#39;</span>
<span class="w">    </span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;pwscf&#39;</span>
<span class="w">    </span><span class="n">pseudo_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./pseudo&#39;</span>
<span class="w">    </span><span class="n">outdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;./work&#39;</span>
<span class="w">    </span><span class="n">tstress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">    </span><span class="n">tprnfor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="o">/</span>

<span class="p">&amp;</span><span class="nb">system</span>
<span class="nb">    </span><span class="n">ibrav</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="n">nat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span>
<span class="w">    </span><span class="n">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="n">ecutwfc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="mf">6.0</span>
<span class="w">    </span><span class="n">ecutrho</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">18</span><span class="mf">0.0</span>
<span class="w">    </span><span class="n">occupations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;smearing&#39;</span>
<span class="w">    </span><span class="n">smearing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;m-p&#39;</span>
<span class="w">    </span><span class="n">degauss</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span>
<span class="w">    </span><span class="n">noncolin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span>
<span class="w">    </span><span class="n">nspin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>
<span class="o">/</span>

<span class="p">&amp;</span><span class="n">electrons</span>
<span class="w">    </span><span class="n">missing_beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span>
<span class="w">    </span><span class="n">conv_thr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-08</span>
<span class="o">/</span>
</pre></div>
</div>
</section>
<section id="id3">
<h2><span class="section-number">3.2. </span>第一原理計算入力ファイルを生成する<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<p>入力パラメータファイル(input.yaml)と結晶構造データ(Co3SnS2_nosym.cif)を入力として cif2x を実行します。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cif2x<span class="w"> </span>-t<span class="w"> </span>QE<span class="w"> </span>input.yaml<span class="w"> </span>Co3SnS2_nosym.cif
</pre></div>
</div>
<p>予め必要な擬ポテンシャルのファイルを <code class="docutils literal notranslate"><span class="pre">./pseudo</span></code> ディレクトリに配置し、擬ポテンシャルのインデックスファイルを <code class="docutils literal notranslate"><span class="pre">./pseudo/pp_psl_pbe_rrkjus.csv</span></code> に作成しておきます。</p>
<p><code class="docutils literal notranslate"><span class="pre">cif2x</span></code> を実行すると Quantum ESPRESSO用の入力ファイルが生成され出力されます。出力先は入力パラメータファイル内のパラメータで指定するディレクトリ(<code class="docutils literal notranslate"><span class="pre">output_dir</span></code>)およびファイル(<code class="docutils literal notranslate"><span class="pre">output_file</span></code>)です。この例では <code class="docutils literal notranslate"><span class="pre">./scf/scf.in</span></code> に SCF計算用の入力ファイルが書き出されます。</p>
</section>
<section id="id4">
<h2><span class="section-number">3.3. </span>パラメータセットを指定する<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h2>
<p>入力パラメータ内の値をいくつか変えながら一連の入力ファイルを生成したいことがあります。例えばカットオフの値やk点の数を変えて収束性を評価するなどの場合です。入力パラメータには値のリストや範囲を指定することができ、値の組み合わせごとに個別のディレクトリを作成して入力ファイルを生成します。
パラメータセットの指定は特別な構文 <code class="docutils literal notranslate"><span class="pre">${...}</span></code> を用います。</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">content</span><span class="p">:</span>
<span class="w">  </span><span class="nt">K_POINTS</span><span class="p">:</span>
<span class="w">    </span><span class="nt">option</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">automatic</span>
<span class="w">    </span><span class="nt">grid</span><span class="p">:</span><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">${ [ [4,4,4], [8,8,8], [12,12,12] ] }</span>
</pre></div>
</div>
<p>例えば上記のように <code class="docutils literal notranslate"><span class="pre">K_POINTS</span></code> を指定すると、 <code class="docutils literal notranslate"><span class="pre">grid</span></code> の値が <code class="docutils literal notranslate"><span class="pre">[4,4,4]</span></code>, <code class="docutils literal notranslate"><span class="pre">[8,8,8]</span></code>, <code class="docutils literal notranslate"><span class="pre">[12,12,12]</span></code> の入力ファイルがそれぞれ <code class="docutils literal notranslate"><span class="pre">4x4x4/</span></code>, <code class="docutils literal notranslate"><span class="pre">8x8x8/</span></code>, <code class="docutils literal notranslate"><span class="pre">12x12x12/</span></code> サブディレクトリ内に作成されます。</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">cif2x Users Guide</a></h1>








<h3>ナビゲーション</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">第一原理計算入力ファイル生成ツール (cif2x)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../about/index.html">1. 概要</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic-usage.html">2. インストールと基本的な使い方</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3. チュートリアル</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command/index.html">4. コマンドリファレンス</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filespec/index.html">5. ファイルフォーマット</a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/index.html">6. 拡張ガイド</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../getcif/index.html">7. CIFデータ取得ツール (getcif)</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">第一原理計算入力ファイル生成ツール (cif2x)</a><ul>
      <li>Previous: <a href="../basic-usage.html" title="前の章へ"><span class="section-number">2. </span>インストールと基本的な使い方</a></li>
      <li>Next: <a href="../command/index.html" title="次の章へ"><span class="section-number">4. </span>コマンドリファレンス</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="検索" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2023-, The University of Tokyo.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../_sources/cif2x/tutorial/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>